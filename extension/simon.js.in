var messageIdCounter = 1

function makeTransportPackage(message) {
  return {
    id: messageIdCounter++,
    message: message,
    timestamp: new Date().toISOString()
  }
}

var port = chrome.runtime.connectNative("@PROJECT_NAME@");

port.onMessage.addListener(function(message) {
  console.log(message);
});

port.onDisconnect.addListener(function() {
  console.log("Disconnected from @PROJECT_NAME@");
});

var simonSays = function(message) {
  chrome.runtime.sendNativeMessage(
    "@PROJECT_NAME@",
    makeTransportPackage(message),
    function(response){
      console.log(response);
  });
}

var simonSays2 = function(message) {
  port.postMessage(makeTransportPackage(message));
}
